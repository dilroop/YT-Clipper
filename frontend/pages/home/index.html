<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a1a">
    <title>YTClipper - YouTube Video Clipper</title>
    <link rel="stylesheet" href="/static/shared/common.css">
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/pages/home/home.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="header-left">
                <a href="/" class="title-link"><h1>YTClipper</h1></a>
            </div>
            <div class="header-buttons">
                <button class="icon-btn" id="galleryBtn" aria-label="Gallery" title="View All Clips">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                </button>
                <button class="icon-btn" id="historyBtn" aria-label="History">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                </button>
                <button class="icon-btn" id="settingsBtn" aria-label="Settings">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main>
            <!-- URL Input Section -->
            <div class="input-section">
                <div class="input-wrapper">
                    <input
                        type="url"
                        id="urlInput"
                        placeholder="Paste YouTube URL here..."
                        aria-label="YouTube URL"
                    >
                    <button class="clear-btn" id="clearBtn" aria-label="Clear input">‚úï</button>
                </div>
                <div class="loading-indicator" id="loadingIndicator" style="display: none;">
                    <div class="spinner"></div>
                    <span>Fetching video info...</span>
                </div>
            </div>

            <!-- Video Preview Section (Hidden by default) -->
            <div class="preview-section" id="previewSection" style="display: none;">
                <!-- Video Header: Thumbnail + Info -->
                <div class="video-header">
                    <div class="thumbnail-wrapper-compact">
                        <img id="thumbnail" src="" alt="Video thumbnail">
                    </div>
                    <div class="video-info-compact">
                        <h2 id="videoTitle">Video Title</h2>
                        <p class="channel-name" id="channelName">Channel Name</p>
                        <p class="duration" id="videoDuration">Duration: 0:00</p>
                    </div>
                </div>

                <!-- Options Grid (2 columns) -->
                <div class="options-grid">
                    <!-- Format Card (spans 2 columns) -->
                    <div class="option-card option-card-full">
                        <h3>Reels Format:</h3>
                        <div class="format-buttons-multi">
                            <!-- Format 1: Vertical 9:16 -->
                            <button class="format-btn-icon active" data-format="vertical_9x16" title="Standard vertical reels with all tracking modes">
                                <div class="format-icon">
                                    <svg width="40" height="60" viewBox="0 0 40 60" fill="none">
                                        <rect x="2" y="2" width="36" height="56" stroke="currentColor" stroke-width="3" rx="4"/>
                                        <text x="20" y="35" text-anchor="middle" fill="currentColor" font-size="10" font-weight="bold">9:16</text>
                                    </svg>
                                </div>
                                <span class="format-label">Vertical</span>
                            </button>

                            <!-- Format 2: Stacked Photo -->
                            <button class="format-btn-icon" data-format="stacked_photo" title="Stacked layout with AI photo on top">
                                <div class="format-icon">
                                    <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                        <!-- Rounded square frame -->
                                        <rect x="4" y="4" width="40" height="40" stroke="currentColor" stroke-width="2.5" rx="8"/>
                                        <!-- AI text -->
                                        <text x="24" y="30" text-anchor="middle" fill="currentColor" font-size="16" font-weight="bold" font-family="Arial, sans-serif">AI</text>
                                        <!-- Sparkle top-right -->
                                        <path d="M36 12 L37 14 L39 14 L37.5 15.5 L38 17 L36 16 L34 17 L34.5 15.5 L33 14 L35 14 Z" fill="currentColor"/>
                                        <!-- Small sparkle top-left -->
                                        <circle cx="14" cy="10" r="1" fill="currentColor"/>
                                        <path d="M14 8 L14 12 M12 10 L16 10" stroke="currentColor" stroke-width="1"/>
                                    </svg>
                                </div>
                                <span class="format-label">Photo</span>
                            </button>

                            <!-- Format 3: Stacked Video -->
                            <button class="format-btn-icon" data-format="stacked_video" title="Stacked layout with AI video on top">
                                <div class="format-icon">
                                    <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                        <!-- Rounded square frame -->
                                        <rect x="4" y="4" width="40" height="40" stroke="currentColor" stroke-width="2.5" rx="8"/>
                                        <!-- Play icon with rounded edges -->
                                        <path d="M19 16 L19 32 L33 24 Z" fill="currentColor" stroke="currentColor" stroke-width="1" stroke-linejoin="round"/>
                                        <!-- Sparkle top-right -->
                                        <path d="M36 12 L37 14 L39 14 L37.5 15.5 L38 17 L36 16 L34 17 L34.5 15.5 L33 14 L35 14 Z" fill="currentColor"/>
                                        <!-- Sparkle bottom-right -->
                                        <path d="M36 36 L37 38 L39 38 L37.5 39.5 L38 41 L36 40 L34 41 L34.5 39.5 L33 38 L35 38 Z" fill="currentColor"/>
                                        <!-- Small sparkle top-left -->
                                        <circle cx="14" cy="10" r="1" fill="currentColor"/>
                                        <path d="M14 8 L14 12 M12 10 L16 10" stroke="currentColor" stroke-width="1"/>
                                    </svg>
                                </div>
                                <span class="format-label">Video</span>
                            </button>

                            <!-- Original Format Option -->
                            <button class="format-btn-icon" data-format="original" title="Original aspect ratio (no reels conversion)">
                                <div class="format-icon">
                                    <svg width="60" height="40" viewBox="0 0 60 40" fill="none">
                                        <rect x="2" y="2" width="56" height="36" stroke="currentColor" stroke-width="3" rx="4"/>
                                        <text x="30" y="25" text-anchor="middle" fill="currentColor" font-size="9" font-weight="bold">16:9</text>
                                    </svg>
                                </div>
                                <span class="format-label">Original</span>
                            </button>
                        </div>
                    </div>

                    <!-- Burn Captions Card -->
                    <div class="option-card">
                        <h3>Captions:</h3>
                        <label class="toggle-label">
                            <input type="checkbox" id="burnCaptionsToggle" checked>
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Burn into Video</span>
                        </label>
                    </div>

                    <!-- AI Strategy Card (spans 2 columns) -->
                    <div class="option-card option-card-full">
                        <h3>AI Strategy:</h3>
                        <select id="aiStrategySelect" class="strategy-dropdown">
                            <option value="viral-moments">Viral Moments</option>
                        </select>
                    </div>
                </div>

                <!-- Auto/Manual Workflow Buttons -->
                <div class="workflow-buttons">
                    <button class="workflow-btn auto-btn" id="autoCreateBtn">
                        <span style="font-size: 24px;">ü§ñ</span> Auto Create
                    </button>
                    <button class="workflow-btn manual-btn" id="manualChooseBtn">
                        <span style="font-size: 24px;">üî®</span> Manually Choose
                    </button>
                </div>
            </div>

            <!-- Clip Selection Section (Hidden by default) -->
            <div class="clip-selection-section" id="clipSelectionSection" style="display: none;">
                <h3>Select Clips to Generate</h3>
                <p class="selection-note">Choose which clips you want to create:</p>
                <div class="clips-list" id="clipsList">
                    <!-- Clips will be loaded here dynamically -->
                </div>
                <button class="generate-btn" id="generateBtn">
                    Generate Selected Clips
                </button>
            </div>

            <!-- Progress Section (Hidden by default) -->
            <div class="progress-section" id="progressSection" style="display: none;">
                <h3>Processing...</h3>

                <!-- Overall Progress Bar -->
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                    <span class="progress-percent" id="progressPercent">0%</span>
                </div>

                <!-- Detailed Progress Stages -->
                <div class="progress-stages">
                    <!-- Stage 1: Downloading -->
                    <div class="progress-stage" data-stage="downloading">
                        <div class="stage-header">
                            <span class="stage-icon">üì•</span>
                            <span class="stage-name">Downloading Video</span>
                            <span class="stage-status" id="status-downloading">Waiting...</span>
                        </div>
                        <div class="stage-details" id="details-downloading"></div>
                    </div>

                    <!-- Stage 2: Transcribing -->
                    <div class="progress-stage" data-stage="transcribing">
                        <div class="stage-header">
                            <span class="stage-icon">üé§</span>
                            <span class="stage-name">Transcribing Audio</span>
                            <span class="stage-status" id="status-transcribing">Waiting...</span>
                        </div>
                        <div class="stage-details" id="details-transcribing"></div>
                    </div>

                    <!-- Stage 3: Analyzing -->
                    <div class="progress-stage" data-stage="analyzing">
                        <div class="stage-header">
                            <span class="stage-icon">ü§ñ</span>
                            <span class="stage-name">AI Analysis</span>
                            <span class="stage-status" id="status-analyzing">Waiting...</span>
                        </div>
                        <div class="stage-details" id="details-analyzing"></div>
                    </div>

                    <!-- Stage 4: Clipping -->
                    <div class="progress-stage" data-stage="clipping">
                        <div class="stage-header">
                            <span class="stage-icon">‚úÇÔ∏è</span>
                            <span class="stage-name">Creating Clips</span>
                            <span class="stage-status" id="status-clipping">Waiting...</span>
                        </div>
                        <div class="stage-details" id="details-clipping"></div>
                    </div>

                    <!-- Stage 5: Organizing -->
                    <div class="progress-stage" data-stage="organizing">
                        <div class="stage-header">
                            <span class="stage-icon">üìÅ</span>
                            <span class="stage-name">Organizing Files</span>
                            <span class="stage-status" id="status-organizing">Waiting...</span>
                        </div>
                        <div class="stage-details" id="details-organizing"></div>
                    </div>
                </div>

                <button class="cancel-btn" id="cancelBtn">Cancel Processing</button>
            </div>

            <!-- Results Section (Hidden by default) -->
            <div class="results-section" id="resultsSection" style="display: none;">
                <h3>‚ú® Clips Ready!</h3>
                <div class="clips-grid" id="clipsGrid">
                    <!-- Clips will be added here dynamically -->
                </div>
            </div>
        </main>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" id="closeModal">‚úï</button>
            </div>
            <div class="modal-body">
                <!-- Caption Settings -->
                <div class="setting-section">
                    <h3>Caption Styling</h3>
                    <p class="setting-note">Use the "Burn Captions" toggle on main screen to enable/disable</p>

                    <div class="setting-item">
                        <label>Words Per Caption:</label>
                        <select id="wordsPerCaption">
                            <option value="1">1 word</option>
                            <option value="2" selected>2 words</option>
                            <option value="3">3 words</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label>Font Family:</label>
                        <select id="fontFamily">
                            <option value="Impact" selected>Impact</option>
                            <option value="Montserrat-Bold">Montserrat Bold</option>
                            <option value="Montserrat-ExtraBold">Montserrat Extra Bold</option>
                            <option value="Roboto">Roboto</option>
                            <option value="Open Sans">Open Sans</option>
                            <option value="Arial">Arial</option>
                            <option value="Helvetica">Helvetica</option>
                            <option value="Comic Sans MS">Comic Sans</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label>Font Size: <span id="fontSizeValue">48</span>px</label>
                        <input type="range" id="fontSize" min="20" max="80" value="48">
                    </div>

                    <div class="setting-item">
                        <label>Vertical Position: <span id="verticalPosValue">80</span>%</label>
                        <input type="range" id="verticalPosition" min="0" max="100" value="80">
                    </div>
                </div>

                <!-- AI Analysis Settings -->
                <div class="setting-section">
                    <h3>AI Clip Validation</h3>
                    <p class="setting-note">Set duration limits for AI-generated clips</p>

                    <div class="setting-item">
                        <label>Minimum Duration: <span id="minDurationValue">15</span>s</label>
                        <input type="range" id="minDuration" min="10" max="30" value="15" step="1">
                    </div>

                    <div class="setting-item">
                        <label>Maximum Duration: <span id="maxDurationValue">60</span>s</label>
                        <input type="range" id="maxDuration" min="30" max="120" value="60" step="5">
                    </div>
                </div>

                <!-- Developer Tools -->
                <div class="setting-section">
                    <h3>Developer Tools</h3>
                    <p class="setting-note">View server logs and diagnostic information</p>
                    <button class="logs-btn" id="viewLogsBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                        View Live Logs
                    </button>
                </div>

                <!-- Watermark Settings -->
                <div class="setting-section">
                    <h3>Watermark</h3>
                    <p class="setting-note">Coming soon in Phase 3</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="save-btn" id="saveSettings">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div class="modal" id="historyModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>History</h2>
                <button class="modal-close" id="closeHistoryModal">‚úï</button>
            </div>
            <div class="modal-body">
                <div id="historyList">
                    <!-- History items will be loaded here -->
                </div>
                <div class="empty-state" id="emptyHistory" style="display: none;">
                    <p style="color: var(--text-secondary); text-align: center; padding: 40px 20px;">
                        No history yet. Paste a YouTube URL to get started!
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="clear-history-btn" id="clearHistoryBtn">Clear History</button>
            </div>
        </div>
    </div>

    <!-- Clip Script Editor Modal -->
    <div class="modal" id="clipEditorModal" style="display: none;">
        <div class="modal-content clip-editor-content">
            <div class="modal-header">
                <h2>Clip Script Editor</h2>
                <button class="modal-close" id="closeClipEditorModal">‚úï</button>
            </div>
            <div class="modal-body clip-editor-body">
                <!-- Clips Section -->
                <div class="editor-clips-section">
                    <div class="editor-section-header">
                        <h3>Clips</h3>
                        <span class="clip-count" id="editorClipCount">0 clips</span>
                    </div>
                    <div class="editor-clips-list" id="editorClipsList">
                        <!-- Clips will be rendered here -->
                    </div>
                </div>

                <!-- Separator -->
                <div class="editor-separator"></div>

                <!-- Transcript Section -->
                <div class="editor-transcript-section">
                    <div class="editor-section-header">
                        <h3>Transcript</h3>
                        <button class="add-clip-btn" id="addClipBtn" title="Add new clip from selection">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </button>
                    </div>
                    <div class="editor-transcript-content" id="editorTranscript">
                        <!-- Transcript will be rendered here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer editor-footer">
                <button class="editor-cancel-btn" id="editorCancelBtn">Cancel</button>
                <button class="editor-save-btn" id="editorSaveBtn">Save Changes</button>
            </div>
        </div>
    </div>
    </div>

    <!-- Keep monolithic script for now, will extract incrementally -->
    <script src="/static/script.js"></script>
    <script src="/static/pages/home/home.js"></script>
</body>
</html>
